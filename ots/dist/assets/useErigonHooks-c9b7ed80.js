import{b0 as h,b1 as v,$ as p,r as d,o as b,b2 as k,am as w,B as P,b3 as C,Y as T,ax as x,b4 as B}from"./index-1a1a81e1.js";const R=[{constant:!0,inputs:[],name:"name",outputs:[{name:"",type:"string"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"_spender",type:"address"},{name:"_value",type:"uint256"}],name:"approve",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[],name:"totalSupply",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"_from",type:"address"},{name:"_to",type:"address"},{name:"_value",type:"uint256"}],name:"transferFrom",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[],name:"decimals",outputs:[{name:"",type:"uint8"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"_owner",type:"address"}],name:"balanceOf",outputs:[{name:"balance",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[],name:"symbol",outputs:[{name:"",type:"string"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"_to",type:"address"},{name:"_value",type:"uint256"}],name:"transfer",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[{name:"_owner",type:"address"},{name:"_spender",type:"address"}],name:"allowance",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{payable:!0,stateMutability:"payable",type:"fallback"},{anonymous:!1,inputs:[{indexed:!0,name:"owner",type:"address"},{indexed:!0,name:"spender",type:"address"},{indexed:!1,name:"value",type:"uint256"}],name:"Approval",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"from",type:"address"},{indexed:!0,name:"to",type:"address"},{indexed:!1,name:"value",type:"uint256"}],name:"Transfer",type:"event"}],S="0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef",E=async(t,e)=>{let s;if(x(e,32))s=t.send("ots_getBlockDetailsByHash",[e]);else{const l=parseInt(e);if(isNaN(l)||l<0)return null;s=t.send("ots_getBlockDetails",[l])}const a=await s;if(a===null)return null;const r=t.formatter.block(a.block),n=a.issuance;return{blockReward:t.formatter.bigNumber(n.blockReward??0),unclesReward:t.formatter.bigNumber(n.uncleReward??0),feeReward:t.formatter.bigNumber(a.totalFees),size:t.formatter.number(a.block.size),sha3Uncles:a.block.sha3Uncles,stateRoot:a.block.stateRoot,totalDifficulty:t.formatter.bigNumber(a.block.totalDifficulty),transactionCount:t.formatter.number(a.block.transactionCount),...r}},F=async([t,e,s,a])=>{const r=await t.send("ots_getBlockTransactions",[e,s,a]),n=t.formatter.blockWithTransactions(r.fullblock),o=r.receipts,l=n.transactions.map((c,i)=>{const f=o[i];f.logs=[];const u=t.formatter.receipt(f);return{blockNumber:e,timestamp:n.timestamp,miner:n.miner,idx:i,hash:c.hash,from:c.from,to:c.to??null,createdContractAddress:u.contractAddress,value:c.value,fee:c.type!==2?t.formatter.bigNumber(u.gasUsed).mul(c.gasPrice):t.formatter.bigNumber(u.gasUsed).mul(c.maxPriorityFeePerGas.add(n.baseFeePerGas)),gasPrice:c.type!==2?c.gasPrice:c.maxPriorityFeePerGas.add(n.baseFeePerGas),data:c.data,status:t.formatter.number(u.status)}}).reverse();return{total:r.fullblock.transactionCount,txs:l}},W=(t,e,s,a)=>{const{data:r,error:n,isLoading:o}=p(t!==void 0?[t,e,s,a]:null,F,{keepPreviousData:!0});return n?{data:void 0,isLoading:!1}:{data:r,isLoading:o}},M=async([t,e])=>E(t,e),N=(t,e)=>{const{data:s,error:a,isLoading:r}=p(t!==void 0&&e!==void 0?[t,e]:null,M,{keepPreviousData:!0});return a?{data:void 0,isLoading:!1}:{data:s,isLoading:r}},z=(t,e)=>{const{data:s}=N(t,e!=null&&e.confirmedData?e.confirmedData.blockNumber.toString():void 0);return s},Y=(t,e)=>{const[s,a]=d.useState();return d.useEffect(()=>{if(!t)return;(async()=>{try{const[n,o]=await Promise.all([t.getTransaction(e),t.getTransactionReceipt(e)]);if(n===null){a(null);return}a({transactionHash:n.hash,from:n.from,to:n.to,value:n.value,type:n.type??0,maxFeePerGas:n.maxFeePerGas,maxPriorityFeePerGas:n.maxPriorityFeePerGas,gasPrice:n.gasPrice,gasLimit:n.gasLimit,nonce:n.nonce,data:n.data,confirmedData:o===null?void 0:{status:o.status===1,blockNumber:o.blockNumber,transactionIndex:o.transactionIndex,confirmations:o.confirmations,createdContractAddress:o.contractAddress,fee:n.gasPrice.mul(o.gasUsed),gasUsed:o.gasUsed,logs:o.logs}})}catch(n){console.error(n),a(null)}})()},[t,e]),s},j=t=>d.useMemo(()=>{if(t.confirmedData)return t.confirmedData.logs.filter(s=>s.topics.length===3&&s.topics[0]===S).map(s=>({token:s.address,from:b(k(w(s.topics[1]),12)),to:b(k(w(s.topics[2]),12)),value:P.from(s.data)}))},[t]),A=(t,e)=>{const{data:s,error:a}=p(t!==void 0&&e!==void 0?["ots_getInternalOperations",e]:null,_(t));return d.useMemo(()=>{if(t===void 0||a||s===void 0)return;const n=[];for(const o of s)n.push({type:o.type,from:t.formatter.address(b(o.from)),to:t.formatter.address(b(o.to)),value:t.formatter.bigNumber(o.value)});return n},[t,s])},Z=(t,e,s)=>{const a=A(t,e);return a===void 0?[void 0,void 0]:[a.findIndex(n=>n.type===C.TRANSFER&&s!==void 0&&s===b(n.to))!==-1,a]},$=(t,e)=>{const[s,a]=d.useState();return d.useEffect(()=>{if(!t){a(void 0);return}(async()=>{const n=await t.send("ots_traceTransaction",[e]);for(let c=0;c<n.length;c++)n[c].from=t.formatter.address(n[c].from),n[c].to=t.formatter.address(n[c].to),n[c].value=n[c].value===null?null:t.formatter.bigNumber(n[c].value);const o=(c,i=0)=>{const f=[];let u=null;for(let m=0;m<c.length;m++)if(c[m].depth===i){if(u!==null){const y=o(u,i+1),g=f.pop();g&&(g.children=y,f.push(g))}f.push({...c[m],children:null}),u=null}else u===null&&(u=[]),u.push(c[m]);if(u!==null){const m=o(u,i+1),y=f.pop();y&&(y.children=m,f.push(y))}return f},l=o(n);a(l)})()},[t,e]),s},D="0x08c379a0",q=(t,e)=>{const[s,a]=d.useState(),[r,n]=d.useState(),[o,l]=d.useState();return d.useEffect(()=>{if(a(void 0),n(void 0),l(void 0),t===void 0)return;(async()=>{const i=await t.send("ots_getTransactionError",[e]);if(i==="0x"){a(void 0),n(i),l(!1);return}if(i.substr(0,10)===D){const u=B.decode(["string"],"0x"+i.substr(10));a(u[0]),n(i),l(!1);return}a(void 0),n(i),l(!0)})()},[t,e]),[s,r,o]},J=(t,e)=>{const{data:s,error:a}=T(t&&e?{provider:t,sender:e}:null,async({provider:r,sender:n})=>r.getTransactionCount(n));if(!a)return s},G=t=>async({network:e,sender:s,nonce:a})=>a<0?void 0:await t.send("ots_getTransactionBySenderAndNonce",[s,a]),K=(t,e,s)=>{const{data:a,error:r}=T(t&&e&&s!==void 0?{network:t.network.chainId,sender:e,nonce:s}:null,G(t));if(!r)return a},Q=(t,e)=>{const{data:s,error:a}=T(t&&e?{type:"cc",network:t.network.chainId,address:e}:null,I(t));if(!a)return s},I=t=>async({network:e,address:s})=>{const a=await t.send("ots_getContractCreator",[s]);return a&&(a.creator=t.formatter.address(a.creator)),a},V=(t,e)=>{const[s,a]=d.useState();return d.useEffect(()=>{if(!t||!e)return;(async()=>{const n=await t.getBalance(e);a(n)})()},[t,e]),s},_=t=>async e=>{if(t===void 0)return;for(const n of e)if(n===void 0)return;const s=e[0],a=e.slice(1);return await t.send(s,a)},X=(t,e,s="latest")=>{const a=_(t),{data:r,error:n}=p(["ots_hasCode",e,s],a);if(!n)return r},U=new h(v,R),O=t=>async([e,s])=>{if(t===void 0)return null;const a=U.connect(t).attach(s);try{const r=await a.name();if(!r.trim())return null;const[n,o]=await Promise.all([a.symbol(),a.decimals()]);return n.trim()?{name:r,symbol:n,decimals:o}:null}catch{return null}},H=(t,e)=>{const s=O(t),{data:a,error:r}=p(t!==void 0&&e!==void 0?["tokenmeta",e]:null,s);if(!r)return a};export{W as a,V as b,Q as c,H as d,X as e,Z as f,Y as g,K as h,J as i,z as j,j as k,q as l,$ as m,R as n,_ as p,E as r,N as u};
