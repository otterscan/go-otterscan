import{r as c,ak as H,j as e,al as G,ah as A,f as _,am as U,b as E,ab as z,t as W,T as q,ad as K,an as Q,H as X,J as I}from"./index-1a1a81e1.js";import{S as Y}from"./StandardFrame-33bf0827.js";import{S as Z}from"./StandardSelectionBoundary-204c519a.js";import{S as ee,C as $}from"./ContentFrame-677dbbad.js";import{N as te}from"./NavBlock-c6c0f531.js";import{J as C,N as L}from"./NavTab-e6699f77.js";import{C as se}from"./react-content-loader.es-44cea70a.js";import{S as re,C as O,B as ae,R as N,A as ne,a as ie}from"./SlashingCount-e74a8791.js";import{I as a}from"./InfoRow-bba0e2d4.js";import{E as w}from"./EpochLink-13106184.js";import{B as V}from"./BlockLink-7a655877.js";import{H as x}from"./HexValue-ca7ab322.js";import"./NavButton-d3ad74da.js";import"./hidden-7488b6ab.js";import"./PercentageBar-a372b68a.js";import"./FormattedBalance-4d723175.js";const oe=({slotNumber:t})=>{const s=H();return e.jsx(ee,{children:e.jsxs("div",{className:"flex items-baseline space-x-1",children:[e.jsx("span",{children:"Slot"}),e.jsxs("span",{className:"text-base text-gray-500",children:["#",t]}),s!==void 0&&e.jsx(te,{entityNum:t,latestEntityNum:s,urlBuilder:G})]})})},le=c.memo(oe),de=({slotNumber:t})=>{const{slot:s,error:r,isLoading:n}=A(t);return e.jsxs(e.Fragment,{children:["Attestations",s&&` (${s.data.message.body.attestations.length??0})`]})},P=()=>e.jsxs(se,{viewBox:"0 0 300 12",children:[e.jsx("rect",{x:"0",y:"4",rx:"1",ry:"1",width:"70",height:"4"}),e.jsx("rect",{x:"75",y:"4",rx:"1",ry:"1",width:"100",height:"4"})]}),ce=({slotNumber:t})=>{const s=H();return e.jsxs("div",{className:"space-y-2 py-4 text-sm",children:[e.jsxs("p",{children:["Slot ",_(t)," data not found."]}),s!==void 0&&t>s?e.jsxs("p",{className:"flex space-x-2",children:[e.jsx("span",{children:"Head slot is:"}),e.jsx(re,{slotNumber:s})]}):e.jsxs(e.Fragment,{children:[e.jsx("p",{children:"Possible causes:"}),e.jsxs("ul",{className:"list-inside list-disc",children:[e.jsx("li",{children:"Missed slot"}),e.jsx("li",{children:"CL does not have the slot data"})]})]})]})},M=c.memo(ce),D=({hex:t})=>{const s=Array.from(U(t));return e.jsx("div",{className:"grid w-fit grid-cols-8 gap-2 font-hash",children:s.map((r,n)=>e.jsx(ue,{b:r},n))})},ue=({b:t})=>{const s=[];for(let r=0;r<8;r++)s.push(t&1<<r?e.jsx("span",{children:"1"},r):e.jsx("span",{className:"text-red-500",children:"0"},r));return e.jsx("span",{children:s})},xe=()=>{const{slotNumber:t}=E();if(t===void 0)throw new Error("slotNumber couldn't be undefined here");const s=parseInt(t),{slot:r,error:n,isLoading:u}=A(s);c.useEffect(()=>{r!==void 0&&(document.title=`Slot #${t} | Otterscan`)},[t,r]);const l=K(s),i=z(s),o=c.useMemo(()=>{try{return r&&W(r.data.message.body.graffiti)}catch(d){console.info("Error while converting slot graffiti to string"),console.info(d)}},[r]);return e.jsx($,{tabs:!0,children:u?e.jsx(P,{}):n?e.jsx(M,{slotNumber:s}):e.jsxs(e.Fragment,{children:[e.jsx(a,{title:"Timestamp",children:i&&e.jsx(q,{value:i})}),e.jsx(a,{title:"Epoch",children:e.jsx(w,{epochNumber:l})}),r.data.message.body.execution_payload&&e.jsx(a,{title:"Block Number",children:e.jsx(V,{blockTag:r.data.message.body.execution_payload.block_number})}),e.jsx(a,{title:"Proposer",children:e.jsx(O,{validatorIndex:r.data.message.proposer_index})}),e.jsx(a,{title:"Block Root",children:e.jsx(ae,{slotNumber:s})}),e.jsx(a,{title:"Parent Root",children:e.jsx(x,{value:r.data.message.parent_root})}),e.jsx(a,{title:"State Root",children:e.jsx(x,{value:r.data.message.state_root})}),e.jsx(a,{title:"Signature",children:e.jsx(x,{value:r.data.signature})}),e.jsx(a,{title:"Randao Reveal",children:e.jsx(x,{value:r.data.message.body.randao_reveal})}),e.jsxs(a,{title:"Graffiti",children:[o," (Hex:"," ",e.jsx(x,{value:r.data.message.body.graffiti}),")"]}),e.jsx(a,{title:"ETH1 Block Hash",children:e.jsx(V,{blockTag:r.data.message.body.eth1_data.block_hash})}),e.jsx(a,{title:"ETH1 Deposit Root",children:e.jsx(x,{value:r.data.message.body.eth1_data.deposit_root})}),e.jsx(a,{title:"ETH1 Deposit Count",children:e.jsx(N,{value:r.data.message.body.eth1_data.deposit_count})}),r.data.message.body.sync_aggregate&&e.jsxs(e.Fragment,{children:[e.jsx(a,{title:"Sync Aggregate Participation",children:e.jsx(ne,{hex:r.data.message.body.sync_aggregate.sync_committee_bits})}),e.jsx(a,{title:"Sync Aggregate Bits",children:e.jsx(D,{hex:r.data.message.body.sync_aggregate.sync_committee_bits})}),e.jsx(a,{title:"Sync Aggregate Signature",children:e.jsx(x,{value:r.data.message.body.sync_aggregate.sync_committee_signature})})]}),e.jsx(a,{title:"Voluntary Exits",children:e.jsx(N,{value:r.data.message.body.voluntary_exits.length})}),e.jsx(a,{title:"Slashings (Attester/Proposer)",children:e.jsx(ie,{slot:r})}),e.jsx(a,{title:"Deposits",children:e.jsx(N,{value:r.data.message.body.deposits.length})})]})})},R=new Map,b=new WeakMap;let F=0,me;function he(t){return t?(b.has(t)||(F+=1,b.set(t,F.toString())),b.get(t)):"0"}function ge(t){return Object.keys(t).sort().filter(s=>t[s]!==void 0).map(s=>`${s}_${s==="root"?he(t.root):t[s]}`).toString()}function je(t){let s=ge(t),r=R.get(s);if(!r){const n=new Map;let u;const l=new IntersectionObserver(i=>{i.forEach(o=>{var d;const j=o.isIntersecting&&u.some(h=>o.intersectionRatio>=h);t.trackVisibility&&typeof o.isVisible>"u"&&(o.isVisible=j),(d=n.get(o.target))==null||d.forEach(h=>{h(j,o)})})},t);u=l.thresholds||(Array.isArray(t.threshold)?t.threshold:[t.threshold||0]),r={id:s,observer:l,elements:n},R.set(s,r)}return r}function fe(t,s,r={},n=me){if(typeof window.IntersectionObserver>"u"&&n!==void 0){const d=t.getBoundingClientRect();return s(n,{isIntersecting:n,target:t,intersectionRatio:typeof r.threshold=="number"?r.threshold:0,time:0,boundingClientRect:d,intersectionRect:d,rootBounds:d}),()=>{}}const{id:u,observer:l,elements:i}=je(r);let o=i.get(t)||[];return i.has(t)||i.set(t,o),o.push(s),l.observe(t),function(){o.splice(o.indexOf(s),1),o.length===0&&(i.delete(t),l.unobserve(t)),i.size===0&&(l.disconnect(),R.delete(u))}}function be({threshold:t,delay:s,trackVisibility:r,rootMargin:n,root:u,triggerOnce:l,skip:i,initialInView:o,fallbackInView:d,onChange:j}={}){var h;const[f,J]=c.useState(null),p=c.useRef(),[v,B]=c.useState({inView:!!o,entry:void 0});p.current=j,c.useEffect(()=>{if(i||!f)return;let g;return g=fe(f,(k,S)=>{B({inView:k,entry:S}),p.current&&p.current(k,S),S.isIntersecting&&l&&g&&(g(),g=void 0)},{root:u,rootMargin:n,threshold:t,trackVisibility:r,delay:s},d),()=>{g&&g()}},[Array.isArray(t)?t.toString():t,f,u,n,l,i,r,d,s]);const y=(h=v.entry)==null?void 0:h.target,T=c.useRef();!f&&y&&!l&&!i&&T.current!==y&&(T.current=y,B({inView:!!o,entry:void 0}));const m=[J,v.inView,v.entry];return m.ref=m[0],m.inView=m[1],m.entry=m[2],m}const pe=({slotNumber:t,committeeIndex:s})=>{const r=Q(t,s);return r?e.jsx("div",{className:"grid grid-cols-8 ",children:r.data[0].validators.map(n=>e.jsx(O,{validatorIndex:n},n))}):e.jsx(e.Fragment,{})},ve=c.memo(pe),ye=({idx:t,att:s})=>{const{ref:r,inView:n}=be({triggerOnce:!0});return e.jsxs("div",{className:"flex space-x-10 py-5",ref:r,children:[e.jsx("div",{children:e.jsx("span",{className:"flex h-12 w-12 items-center justify-center rounded-full bg-emerald-50 text-emerald-500",children:t})}),e.jsxs("div",{className:"w-full divide-y bg-white px-3",children:[e.jsx(a,{title:"Slot",children:_(s.data.slot.toString())}),e.jsx(a,{title:"Committee Index",children:_(s.data.index.toString())}),n&&e.jsxs(e.Fragment,{children:[e.jsx(a,{title:"Aggregation Bits",children:e.jsx(D,{hex:s.aggregation_bits})}),e.jsx(a,{title:"Validators",children:e.jsx(ve,{slotNumber:s.data.slot,committeeIndex:s.data.index})})]}),e.jsx(a,{title:"Beacon Block Root",children:e.jsx(x,{value:s.data.beacon_block_root})}),e.jsx(a,{title:"Source",children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(w,{epochNumber:s.data.source.epoch}),e.jsx("span",{children:"/"}),e.jsx(x,{value:s.data.source.root})]})}),e.jsx(a,{title:"Target",children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(w,{epochNumber:s.data.target.epoch}),e.jsx("span",{children:"/"}),e.jsx(x,{value:s.data.target.root})]})}),e.jsx(a,{title:"Signature",children:e.jsx(x,{value:s.signature})})]})]})},Se=()=>{const{slotNumber:t}=E();if(t===void 0)throw new Error("slotNumber couldn't be undefined here");const s=parseInt(t),{slot:r,error:n,isLoading:u}=A(s);return c.useEffect(()=>{r!==void 0&&(document.title=`Attestations for #${t} | Otterscan`)},[t,r]),e.jsx($,{tabs:!0,children:u?e.jsx(P,{}):n?e.jsx(M,{slotNumber:s}):e.jsx(e.Fragment,{children:r.data.message.body.attestations.map((l,i)=>e.jsx(ye,{idx:i,att:l},i))})})},Oe=()=>{const{slotNumber:t}=E();if(t===void 0)throw new Error("slotNumber couldn't be undefined here");const s=parseInt(t);return e.jsxs(Y,{children:[e.jsx(le,{slotNumber:s}),e.jsxs(Z,{children:[e.jsx(C.Group,{children:e.jsxs(C.List,{className:"flex space-x-2 rounded-t-lg border-l border-r border-t bg-white",children:[e.jsx(L,{href:".",children:"Overview"}),e.jsx(L,{href:"attestations",children:e.jsx(de,{slotNumber:s})})]})}),e.jsx(c.Suspense,{fallback:null,children:e.jsxs(X,{children:[e.jsx(I,{index:!0,element:e.jsx(xe,{})}),e.jsx(I,{path:"attestations",element:e.jsx(Se,{})})]})})]})]})};export{Oe as default};
